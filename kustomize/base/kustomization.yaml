# - Base(ê¸°ë³¸) ë¦¬ì†ŒìŠ¤ ëª©ë¡ ì •ì˜
# - ëª¨ë“  í™˜ê²½ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì„¤ì •
# - Overlays(dev, prod)ì—ì„œ ì´ baseë¥¼ ì°¸ì¡°

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
metadata:
  name: exchange-settlement-base
# ìˆœì„œ ì¤‘ìš”!
# ì˜ì¡´ì„± ìˆëŠ” ë¦¬ì†ŒìŠ¤ëŠ” ë¨¼ì € ì •ì˜ (Namespace â†’ ë‚˜ë¨¸ì§€)
resources:
  - namespace.yaml # ğŸ†• 1ìˆœìœ„: ë‹¤ë¥¸ ëª¨ë“  ë¦¬ì†ŒìŠ¤ì˜ ì»¨í…Œì´ë„ˆ
  - serviceaccount.yaml # ğŸ†• 2ìˆœìœ„: Deploymentì—ì„œ ì°¸ì¡°
  - rbac.yaml # ğŸ†• 3ìˆœìœ„: SA ê´€ë ¨ ê¶Œí•œ
  - clustersecretstore.yaml # External Secretsê°€ AWS ì—°ê²°í•˜ëŠ” ì„¤ì •
  - externalsecret.yaml # SecretStore í•„ìš”
  - deployment.yaml # ServiceAccount, Secret ì°¸ì¡°
  - service.yaml # Deployment ì°¸ì¡°
  - ingress.yaml # ë…ë¦½ì 
  - networkpolicy.yaml # ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì •ì±…
commonLabels:
  # part-of: ì´ ë¦¬ì†ŒìŠ¤ê°€ ì†í•œ ìƒìœ„ ì• í”Œë¦¬ì¼€ì´ì…˜
  app.kubernetes.io/part-of: exchange-settlement
  app.kubernetes.io/managed-by: kustomize
images:
  - name: app # deployment.yamlì˜ imageì™€ ë§¤ì¹­
    newName: app # ì‹¤ì œ ì´ë¯¸ì§€ ì´ë¦„ (overlaysì—ì„œ ECR URLë¡œ ë³€ê²½)
    newTag: latest # íƒœê·¸ (overlaysì—ì„œ latest-dev, latest-prodë¡œ ë³€ê²½)
